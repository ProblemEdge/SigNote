<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S1gNqte - 記号とタグで思考を整理するSNS</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            min-height: 100vh;
            color: #212529;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 20px;
            border: 1px solid rgba(0, 0, 0, 0.05);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: #212529;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: none;
        }

        .header p {
            color: #6c757d;
            font-size: 1.1rem;
        }

        .post-composer {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .ocr-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px dashed #dee2e6;
        }

        .ocr-section h4 {
            margin-bottom: 15px;
            color: #495057;
        }

        .upload-area {
            border: 2px dashed #0066FF;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .upload-area:hover {
            background: #f0f8ff;
            border-color: #0052CC;
        }

        .upload-area.dragover {
            background: #e6f3ff;
            border-color: #0052CC;
            transform: scale(1.02);
        }

        .upload-content .upload-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .upload-content p {
            margin: 0 0 5px 0;
            font-weight: 500;
            color: #495057;
        }

        .upload-content small {
            color: #6c757d;
        }

        .ocr-result {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border-left: 4px solid #28a745;
        }

        .ocr-result h5 {
            margin: 0 0 10px 0;
            color: #28a745;
        }

        .ocr-text {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            margin-bottom: 10px;
            border: 1px solid #dee2e6;
            min-height: 60px;
        }

        .apply-ocr-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .apply-ocr-btn:hover {
            background: #218838;
            transform: translateY(-1px);
        }

        .processing {
            text-align: center;
            color: #0066FF;
            font-style: italic;
        }

        .processing::after {
            content: '...';
            animation: dots 1.5s infinite;
        }

        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }

        .symbol-toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .symbol-btn {
            background: white;
            border: 1px solid #dee2e6;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            color: #212529;
        }

        .symbol-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 102, 255, 0.15);
            background: #0066FF;
            color: white;
            border-color: #0066FF;
        }

        .symbol-btn:active {
            transform: translateY(0);
        }

        .post-input {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            font-size: 1rem;
            font-family: 'Courier New', monospace;
            resize: vertical;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            background: #fafafa;
        }

        .post-input:focus {
            outline: none;
            border-color: #0066FF;
            box-shadow: 0 0 0 3px rgba(0, 102, 255, 0.1);
            background: white;
        }

        .tag-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 0.9rem;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            background: #fafafa;
        }

        .tag-input:focus {
            outline: none;
            border-color: #0066FF;
            background: white;
            box-shadow: 0 0 0 3px rgba(0, 102, 255, 0.1);
        }

        .post-btn {
            background: #0066FF;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 102, 255, 0.3);
        }

        .post-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 102, 255, 0.4);
            background: #0052CC;
        }

        .posts {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .post {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border-left: 4px solid #0066FF;
            transition: all 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .post:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        }

        .post-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .post-user {
            font-weight: bold;
            color: #212529;
        }

        .post-time {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .post-content {
            font-family: 'Courier New', monospace;
            line-height: 1.6;
            white-space: pre-wrap;
            margin-bottom: 15px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 3px solid #0066FF;
            color: #212529;
        }

        .post-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .tag {
            background: #212529;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tag:hover {
            transform: scale(1.05);
            background: #0066FF;
            box-shadow: 0 2px 8px rgba(0, 102, 255, 0.3);
        }

        .search-filter {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .search-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1rem;
            margin-bottom: 15px;
            background: #fafafa;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #0066FF;
            background: white;
            box-shadow: 0 0 0 3px rgba(0, 102, 255, 0.1);
        }

        .filter-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .filter-tag {
            background: #f0f0f0;
            color: #333;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .filter-tag:hover {
            background: #e0e0e0;
        }

        .filter-tag.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #4a5ed1;
        }

        .symbol-guide {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .guide-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .guide-item {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }

        .guide-symbol {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
        }

        .guide-name {
            font-weight: bold;
            margin: 5px 0;
        }

        .guide-desc {
            font-size: 0.9rem;
            color: #666;
        }

        .message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 0.9rem;
            transform: translateX(300px);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .message.show {
            transform: translateX(0);
        }

        @media (max-width: 600px) {
            .container {
                padding: 10px;
            }
            
            .symbol-toolbar {
                gap: 5px;
            }
            
            .symbol-btn {
                font-size: 1rem;
                padding: 6px 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🧠 SigNote</h1>
            <p>記号とタグで思考を整理・共有するSNS</p>
        </div>

        <div class="symbol-guide">
            <h3>📋 記号ガイド</h3>
            <div class="guide-grid">
                <div class="guide-item">
                    <div class="guide-symbol">●</div>
                    <div class="guide-name">#core</div>
                    <div class="guide-desc">重要・中心・主張の核</div>
                </div>
                <div class="guide-item">
                    <div class="guide-symbol">→</div>
                    <div class="guide-name">#flow</div>
                    <div class="guide-desc">物事の順番・因果関係</div>
                </div>
                <div class="guide-item">
                    <div class="guide-symbol">▢</div>
                    <div class="guide-name">#block</div>
                    <div class="guide-desc">概念・話題・テーマの枠組み</div>
                </div>
                <div class="guide-item">
                    <div class="guide-symbol">★</div>
                    <div class="guide-name">#highlight</div>
                    <div class="guide-desc">印象・注目ポイント</div>
                </div>
                <div class="guide-item">
                    <div class="guide-symbol">↺</div>
                    <div class="guide-name">#loop</div>
                    <div class="guide-desc">見直し・改善・反復</div>
                </div>
                <div class="guide-item">
                    <div class="guide-symbol">≡</div>
                    <div class="guide-name">#tag</div>
                    <div class="guide-desc">複数要素の共通属性</div>
                </div>
                <div class="guide-item">
                    <div class="guide-symbol">⧉</div>
                    <div class="guide-name">#ref</div>
                    <div class="guide-desc">他のノート・本との接続</div>
                </div>
                <div class="guide-item">
                    <div class="guide-symbol">⇄</div>
                    <div class="guide-name">#compare</div>
                    <div class="guide-desc">対立・比較・選択</div>
                </div>
            </div>
        </div>

        <div class="search-filter">
            <h3>🔍 検索・フィルター</h3>
            <input type="text" class="search-input" placeholder="キーワードやタグで検索..." id="searchInput">
            <div class="filter-tags" id="filterTags">
                <div class="filter-tag" data-tag="core">core</div>
                <div class="filter-tag" data-tag="flow">flow</div>
                <div class="filter-tag" data-tag="block">block</div>
                <div class="filter-tag" data-tag="highlight">highlight</div>
                <div class="filter-tag" data-tag="loop">loop</div>
                <div class="filter-tag" data-tag="learning">learning</div>
                <div class="filter-tag" data-tag="habits">habits</div>
                <div class="filter-tag" data-tag="productivity">productivity</div>
            </div>
        </div>

        <div class="post-composer">
            <h3>✍️ 新しいノートを作成</h3>
            
            <!-- 画像アップロード・OCR機能 -->
            <div class="ocr-section">
                <h4>📷 手書きメモをアップロード (デモ)</h4>
                <div class="upload-area" id="uploadArea">
                    <input type="file" id="imageInput" accept="image/*" style="display: none;">
                    <div class="upload-content">
                        <div class="upload-icon">📸</div>
                        <p>画像をドラッグ&ドロップ、またはクリックして選択</p>
                        <small>手書きメモや記号を自動でテキスト化します</small>
                    </div>
                </div>
                <div class="ocr-result" id="ocrResult" style="display: none;">
                    <h5>認識結果:</h5>
                    <div class="ocr-text" id="ocrText"></div>
                    <button class="apply-ocr-btn" onclick="applyOcrText()">テキストエリアに反映</button>
                </div>
            </div>
            
            <div class="symbol-toolbar">
                <button class="symbol-btn" data-symbol="●">● core</button>
                <button class="symbol-btn" data-symbol="→">→ flow</button>
                <button class="symbol-btn" data-symbol="▢">▢ block</button>
                <button class="symbol-btn" data-symbol="★">★ highlight</button>
                <button class="symbol-btn" data-symbol="↺">↺ loop</button>
                <button class="symbol-btn" data-symbol="≡">≡ tag</button>
                <button class="symbol-btn" data-symbol="⧉">⧉ ref</button>
                <button class="symbol-btn" data-symbol="⇄">⇄ compare</button>
            </div>
            <textarea class="post-input" id="postInput" placeholder="記号やタグを使って思考を整理してみましょう...

🔄 自動変換機能：
#core → ●　#flow → →　#block → ▢　#highlight → ★
#loop → ↺　#tag → ≡　#ref → ⧉　#compare → ⇄

例:
#block 習慣化の壁
　#core やる気が続かない
　#flow モチベーション曲線を知る
　#loop 失敗した記録を見直す
　#highlight 達成率を数値化してみる
　#ref 「習慣の力」第4章"></textarea>
            <input type="text" class="tag-input" id="tagInput" placeholder="タグを入力 (例: #習慣 #学習 #生産性)">
            <button class="post-btn" onclick="createPost()">投稿する</button>
        </div>

        <div class="posts" id="posts">
            <!-- サンプル投稿 -->
            <div class="post">
                <div class="post-header">
                    <div class="post-user">思考整理マスター</div>
                    <div class="post-time">5分前</div>
                </div>
                <div class="post-content">▢学習効率化
　●集中力が続かない問題
　→ポモドーロテクニック導入
　★25分集中→5分休憩が効果的
　↺週末に振り返りをする
　⧉「集中力」本田直之 第2章
　
A ⇄ B の比較
　長時間学習 ⇄ 短時間集中
　★短時間集中の方が記憶定着率UP</div>
                <div class="post-tags">
                    <div class="tag">#learning</div>
                    <div class="tag">#productivity</div>
                    <div class="tag">#core</div>
                    <div class="tag">#flow</div>
                </div>
            </div>

            <div class="post">
                <div class="post-header">
                    <div class="post-user">ライフハッカー</div>
                    <div class="post-time">1時間前</div>
                </div>
                <div class="post-content">▢朝のルーティン改善
　●起床時間がバラバラ
　→アラーム時間を固定
　→前日の準備を充実させる
　★起床後の水分補給が重要
　↺月末に効果測定
　
≡共通点：継続が鍵
≡タグ：#morning #routine #health</div>
                <div class="post-tags">
                    <div class="tag">#habits</div>
                    <div class="tag">#morning</div>
                    <div class="tag">#health</div>
                    <div class="tag">#block</div>
                </div>
            </div>

            <div class="post">
                <div class="post-header">
                    <div class="post-user">読書好き</div>
                    <div class="post-time">3時間前</div>
                </div>
                <div class="post-content">▢読書メモ術
　●読んだ内容を忘れてしまう
　→読書ノートに記号で整理
　★重要箇所は●マークで強調
　⧉他の本との関連性を→で繋ぐ
　↺月1回でノートを見直し
　
デジタル ⇄ アナログ
　★アナログの方が記憶に残りやすい</div>
                <div class="post-tags">
                    <div class="tag">#reading</div>
                    <div class="tag">#notes</div>
                    <div class="tag">#memory</div>
                    <div class="tag">#ref</div>
                    <div class="tag">#compare</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let posts = [];
        let activeFilters = new Set();
        let currentOcrText = '';

        // タグから記号への変換マップ
        const tagToSymbolMap = {
            '#core': '●',
            '#flow': '→',
            '#block': '▢',
            '#highlight': '★',
            '#loop': '↺',
            '#tag': '≡',
            '#ref': '⧉',
            '#compare': '⇄'
        };

        // OCR機能の初期化
        function initOCR() {
            const uploadArea = document.getElementById('uploadArea');
            const imageInput = document.getElementById('imageInput');

            // クリックでファイル選択
            uploadArea.addEventListener('click', () => {
                imageInput.click();
            });

            // ドラッグ&ドロップ
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleImageFile(files[0]);
                }
            });

            // ファイル選択
            imageInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleImageFile(e.target.files[0]);
                }
            });
        }

        // 画像ファイルの処理（デモ版）
        function handleImageFile(file) {
            if (!file.type.startsWith('image/')) {
                alert('画像ファイルを選択してください');
                return;
            }

            // デモ用のサンプルテキスト
            const sampleOcrTexts = [
                '以下テンプレ',
                '● 今日のタスク\n→ 資料作成\n→ ミーティング準備\n★ 重要：明日までに完了',
                '▢ 読書メモ\n● 習慣の力\n→ 小さな変化が大きな結果を生む\n↺ 21日間継続してみる',
                '▢ アイデア整理\n● 新しいプロジェクト案\n→ 市場調査が必要\n⧉ 競合分析も参考に'
            ];

            const randomText = sampleOcrTexts[Math.floor(Math.random() * sampleOcrTexts.length)];
            performDemoOCR(randomText);
        }

        // デモ版OCR実行
        function performDemoOCR(text) {
            const ocrResult = document.getElementById('ocrResult');
            const ocrText = document.getElementById('ocrText');
            
            ocrResult.style.display = 'block';
            ocrText.innerHTML = '<div class="processing">画像を解析中</div>';

            // デモ用の遅延処理
            setTimeout(() => {
                ocrText.innerHTML = '<div class="processing">テキスト認識中 50%</div>';
            }, 500);

            setTimeout(() => {
                ocrText.innerHTML = '<div class="processing">テキスト認識中 100%</div>';
            }, 1000);

            setTimeout(() => {
                currentOcrText = text;
                ocrText.textContent = text;
                showMessage('OCR処理が完了しました（デモ版）');
            }, 1500);
        }

        // OCRテキストをテキストエリアに適用
        function applyOcrText() {
            const postInput = document.getElementById('postInput');
            const currentText = postInput.value;
            
            if (currentText.trim() === '') {
                postInput.value = currentOcrText;
            } else {
                postInput.value = currentText + '\n\n' + currentOcrText;
            }
            
            // 自動変換を実行
            autoConvertTags(postInput);
            
            // フォーカスを当てる
            postInput.focus();
            postInput.scrollTop = postInput.scrollHeight;
            
            showMessage('OCRテキストが反映されました');
        }

        // 自動変換機能
        function autoConvertTags(input) {
            let text = input.value;
            let cursorPos = input.selectionStart;
            let converted = false;
            let offsetAdjustment = 0;

            // 各タグを記号に変換
            Object.entries(tagToSymbolMap).forEach(([tag, symbol]) => {
                const regex = new RegExp(tag.replace('#', '\\#'), 'gi');
                const matches = Array.from(text.matchAll(regex));
                
                matches.forEach(match => {
                    const matchStart = match.index;
                    const matchEnd = matchStart + match[0].length;
                    
                    // カーソル位置より前の変換の場合、オフセットを調整
                    if (matchEnd <= cursorPos) {
                        offsetAdjustment += symbol.length - tag.length;
                    }
                    
                    converted = true;
                });
                
                text = text.replace(regex, symbol);
            });

            if (converted) {
                input.value = text;
                // カーソル位置を調整
                input.setSelectionRange(cursorPos + offsetAdjustment, cursorPos + offsetAdjustment);
                
                // 変換エフェクト
                input.style.backgroundColor = '#e8f4fd';
                setTimeout(() => {
                    input.style.backgroundColor = '';
                }, 300);
            }
        }

        // 記号ボタンのクリック処理
        function addSymbol(symbol) {
            const postInput = document.getElementById('postInput');
            const cursorPos = postInput.selectionStart;
            const textBefore = postInput.value.substring(0, cursorPos);
            const textAfter = postInput.value.substring(cursorPos);
            
            postInput.value = textBefore + symbol + ' ' + textAfter;
            postInput.focus();
            postInput.setSelectionRange(cursorPos + symbol.length + 1, cursorPos + symbol.length + 1);
        }

        // 投稿作成
        function createPost() {
            const postInput = document.getElementById('postInput');
            const tagInput = document.getElementById('tagInput');
            const content = postInput.value.trim();
            const tags = tagInput.value.trim();

            if (!content) {
                alert('投稿内容を入力してください');
                return;
            }
const post = {
            id: Date.now(),
            user: 'あなた',
            content: content,
            tags: tags ? tags.split(' ').filter(tag => tag.startsWith('#')) : [],
            timestamp: new Date(),
            time: '今'
        };

        posts.unshift(post);
        renderPosts();
        
        // フォームをクリア
        postInput.value = '';
        tagInput.value = '';
        
        // OCR結果もクリア
        const ocrResult = document.getElementById('ocrResult');
        ocrResult.style.display = 'none';
        currentOcrText = '';
        
        showMessage('投稿しました！');
    }

    // 投稿を表示
    function renderPosts() {
        const postsContainer = document.getElementById('posts');
        const searchTerm = document.getElementById('searchInput').value.toLowerCase();
        
        // フィルタリング
        let filteredPosts = posts.filter(post => {
            // 検索条件でフィルタ
            const matchesSearch = !searchTerm || 
                post.content.toLowerCase().includes(searchTerm) ||
                post.tags.some(tag => tag.toLowerCase().includes(searchTerm));
            
            // アクティブなフィルタでフィルタ
            const matchesFilter = activeFilters.size === 0 || 
                Array.from(activeFilters).some(filter => 
                    post.tags.some(tag => tag.toLowerCase().includes(filter.toLowerCase())) ||
                    post.content.toLowerCase().includes(filter.toLowerCase())
                );
            
            return matchesSearch && matchesFilter;
        });

        // 既存のカスタム投稿を保持
        const customPosts = Array.from(postsContainer.children).filter(post => 
            post.querySelector('.post-user').textContent === 'あなた'
        );

        // サンプル投稿
        const samplePosts = `
            <div class="post">
                <div class="post-header">
                    <div class="post-user">思考整理マスター</div>
                    <div class="post-time">5分前</div>
                </div>
                <div class="post-content">▢学習効率化
　●集中力が続かない問題
　→ポモドーロテクニック導入
　★25分集中→5分休憩が効果的
　↺週末に振り返りをする
　⧉「集中力」本田直之 第2章
　
A ⇄ B の比較
　長時間学習 ⇄ 短時間集中
　★短時間集中の方が記憶定着率UP</div>
                <div class="post-tags">
                    <div class="tag">#learning</div>
                    <div class="tag">#productivity</div>
                    <div class="tag">#core</div>
                    <div class="tag">#flow</div>
                </div>
            </div>

            <div class="post">
                <div class="post-header">
                    <div class="post-user">ライフハッカー</div>
                    <div class="post-time">1時間前</div>
                </div>
                <div class="post-content">▢朝のルーティン改善
　●起床時間がバラバラ
　→アラーム時間を固定
　→前日の準備を充実させる
　★起床後の水分補給が重要
　↺月末に効果測定
　
≡共通点：継続が鍵
≡タグ：#morning #routine #health</div>
                <div class="post-tags">
                    <div class="tag">#habits</div>
                    <div class="tag">#morning</div>
                    <div class="tag">#health</div>
                    <div class="tag">#block</div>
                </div>
            </div>

            <div class="post">
                <div class="post-header">
                    <div class="post-user">読書好き</div>
                    <div class="post-time">3時間前</div>
                </div>
                <div class="post-content">▢読書メモ術
　●読んだ内容を忘れてしまう
　→読書ノートに記号で整理
　★重要箇所は●マークで強調
　⧉他の本との関連性を→で繋ぐ
　↺月1回でノートを見直し
　
デジタル ⇄ アナログ
　★アナログの方が記憶に残りやすい</div>
                <div class="post-tags">
                    <div class="tag">#reading</div>
                    <div class="tag">#notes</div>
                    <div class="tag">#memory</div>
                    <div class="tag">#ref</div>
                    <div class="tag">#compare</div>
                </div>
            </div>
        `;

        // 新しい投稿のHTML生成
        const newPostsHTML = filteredPosts.map(post => `
            <div class="post">
                <div class="post-header">
                    <div class="post-user">${post.user}</div>
                    <div class="post-time">${post.time}</div>
                </div>
                <div class="post-content">${post.content}</div>
                <div class="post-tags">
                    ${post.tags.map(tag => `<div class="tag">${tag}</div>`).join('')}
                </div>
            </div>
        `).join('');

        postsContainer.innerHTML = newPostsHTML + samplePosts;
    }

    // フィルタータグの処理
    function toggleFilter(tagElement) {
        const tag = tagElement.dataset.tag;
        
        if (activeFilters.has(tag)) {
            activeFilters.delete(tag);
            tagElement.classList.remove('active');
        } else {
            activeFilters.add(tag);
            tagElement.classList.add('active');
        }
        
        renderPosts();
    }

    // メッセージ表示
    function showMessage(text) {
        const message = document.createElement('div');
        message.className = 'message';
        message.textContent = text;
        document.body.appendChild(message);
        
        setTimeout(() => {
            message.classList.add('show');
        }, 100);
        
        setTimeout(() => {
            message.classList.remove('show');
            setTimeout(() => {
                document.body.removeChild(message);
            }, 300);
        }, 2000);
    }

    // イベントリスナーの設定
    document.addEventListener('DOMContentLoaded', function() {
        // OCR機能の初期化
        initOCR();
        
        // 記号ボタンのクリック
        document.querySelectorAll('.symbol-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const symbol = btn.dataset.symbol;
                addSymbol(symbol);
            });
        });

        // 自動変換機能
        const postInput = document.getElementById('postInput');
        postInput.addEventListener('input', () => {
            autoConvertTags(postInput);
        });

        // 検索機能
        const searchInput = document.getElementById('searchInput');
        searchInput.addEventListener('input', renderPosts);

        // フィルタータグ
        document.querySelectorAll('.filter-tag').forEach(tag => {
            tag.addEventListener('click', () => {
                toggleFilter(tag);
            });
        });

        // 投稿タグのクリック（検索に追加）
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('tag')) {
                const tagText = e.target.textContent;
                const searchInput = document.getElementById('searchInput');
                searchInput.value = tagText;
                renderPosts();
                searchInput.focus();
            }
        });

        // 初期表示
        renderPosts();
    });
    </script>
</body>
</html>
